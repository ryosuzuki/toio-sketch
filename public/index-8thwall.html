<!doctype html>
<html>
  <head>
    <title>Toio Sketch - 8th Wall</title>
    <link rel="shortcut icon" href="#" />
    <script src="https://cdn.8thwall.com/web/aframe/8frame-1.2.0.min.js"></script>
    <script src="https://cdn.8thwall.com/web/xrextras/xrextras.js"></script>
    <script async src="https://apps.8thwall.com/xrweb?appKey=aIosYEDG37bs43LDn2FWvxVSjU4XVGKwRu3M3Y7p9V1KTWrtUOXArhFOuLFpzJmw2qfV7t"></script>

    <script>
      let calibrated = false
      AFRAME.registerComponent('tap-place', {
        init() {
          const ground = document.getElementById('ground')
          ground.addEventListener('click', (event) => {
            if (calibrated) return false
            const newElement = document.createElement('a-sphere')
            const touchPoint = event.detail.intersection.point
            newElement.setAttribute('position', touchPoint)
            newElement.setAttribute('radius', '0.1')
            newElement.setAttribute('color', 'red')
            this.el.sceneEl.appendChild(newElement)
            window.touchPoint = touchPoint
            let el = document.querySelector('#drawing-plane')
            el.setAttribute('position', touchPoint)
            calibrated = true
          })
        },
      })

    </script>

  </head>
  <body>
    <a-scene
      tap-place
      xrextras-almost-there
      xrextras-loading
      xrextras-runtime-error
      renderer="colorManagement:true"
      xrweb="allowedDevices:any;"
      background="color: #eee"
    >
      <a-entity id="root"></a-entity>
      <a-camera id="camera" look-controls="false" position="0 8 0" raycaster="objects: .cantap" cursor="fuse: false; rayOrigin: mouse;"></a-camera>
      <a-box
        id="ground"
        class="cantap"
        scale="1000 2 1000"
        position="0 -1 0"
        material="shader: shadow; transparent: true; opacity: 0.4"
        shadow>
      </a-box>
    </a-scene>
    <canvas id="matter-canvas"></canvas>
  </body>
</html>